# æµ‹è¯•è„šæœ¬æ‰§è¡Œå¼‚å¸¸çš„é—®é¢˜è§£å†³æ–¹æ¡ˆ

## ğŸš¨ é—®é¢˜åˆ†æ

æ‰§è¡Œ `./test_mcp_gateway/run_all_tests.sh` æ—¶é‡åˆ°çš„ä¸»è¦é—®é¢˜ï¼š

1. **Bash ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜**
   - macOS é»˜è®¤ä½¿ç”¨è¾ƒè€çš„ bash 3.x ç‰ˆæœ¬
   - è„šæœ¬ä½¿ç”¨äº† `declare -A`ï¼ˆå…³è”æ•°ç»„ï¼‰ï¼Œéœ€è¦ bash 4.0+

2. **Docker Compose å‘½ä»¤é—®é¢˜**  
   - æ–°ç‰ˆ Docker ä½¿ç”¨ `docker compose`ï¼ˆæ— è¿å­—ç¬¦ï¼‰
   - æ—§ç‰ˆä½¿ç”¨ `docker-compose`ï¼ˆæœ‰è¿å­—ç¬¦ï¼‰

3. **Docker å®ˆæŠ¤è¿›ç¨‹æœªè¿è¡Œ**
   - Docker Desktop æ²¡æœ‰å¯åŠ¨
   - å®¹å™¨åŒ–çš„æ•°æ®åº“æœåŠ¡æ— æ³•å¯åŠ¨

## âœ… å·²å®æ–½çš„è§£å†³æ–¹æ¡ˆ

### 1. ä¿®å¤äº† Bash å…¼å®¹æ€§
- æ·»åŠ äº† bash ç‰ˆæœ¬æ£€æµ‹
- æä¾›äº†å…¼å®¹æ—§ç‰ˆæœ¬ bash çš„æ•°ç»„å¤„ç†æ–¹å¼
- ä½¿ç”¨ `#!/usr/bin/env bash` æ›¿ä»£ `#!/bin/bash`

### 2. ä¿®å¤äº† Docker Compose é—®é¢˜
- è‡ªåŠ¨æ£€æµ‹ `docker-compose` æˆ– `docker compose` å‘½ä»¤
- æ ¹æ®å¯ç”¨å‘½ä»¤åŠ¨æ€è®¾ç½® `DOCKER_COMPOSE_CMD` å˜é‡
- ä¼˜é›…å¤„ç† Docker ä¸å¯ç”¨çš„æƒ…å†µ

### 3. åˆ›å»ºäº†å¤šä¸ªæµ‹è¯•çº§åˆ«

#### ğŸ“‹ **ç®€å•æµ‹è¯•** (`simple_test.sh`)
```bash
./test_mcp_gateway/simple_test.sh
```
- âœ… éªŒè¯åŸºæœ¬åŠŸèƒ½ï¼ˆ4ä¸ªæ ¸å¿ƒæµ‹è¯•ï¼‰
- ğŸš€ æ— éœ€ Dockerï¼Œä½¿ç”¨ç°æœ‰ MySQL
- â±ï¸ 1-2 åˆ†é’Ÿå®Œæˆ

#### ğŸ” **è¯Šæ–­è„šæœ¬** (`diagnose.sh`)
```bash
./test_mcp_gateway/diagnose.sh
```
- ğŸ” æ£€æµ‹ç³»ç»Ÿç¯å¢ƒå’Œä¾èµ–
- ğŸ“Š åˆ†æé—®é¢˜å¹¶æä¾›è§£å†³å»ºè®®
- ğŸ› ï¸ æ•…éšœæ’é™¤æŒ‡å—

#### ğŸ§ª **æ— Dockeræµ‹è¯•** (`test_without_docker.sh`)
```bash
./test_mcp_gateway/test_without_docker.sh
```
- ğŸ“¦ å…¨é¢æµ‹è¯•ï¼ˆæ— éœ€ Docker å®¹å™¨ï¼‰
- ğŸ—„ï¸ ä½¿ç”¨ç°æœ‰çš„ MySQL æ•°æ®åº“
- ğŸ”„ æµ‹è¯•æ‰€æœ‰æ ¸å¿ƒåè®®

## ğŸ¯ å½“å‰æµ‹è¯•çŠ¶æ€

### âœ… å·²éªŒè¯å¯ç”¨çš„åŠŸèƒ½ï¼š
- **mcp-server æ„å»º** âœ…
- **MySQL æ•°æ®åº“è¿æ¥** âœ… (127.0.0.1:3311)
- **HTTP REST API æœåŠ¡å™¨** âœ… (ç«¯å£ 8080)
- **MCP stdio åè®®** âœ…
- **MCP over HTTP åè®®** âœ… (ç«¯å£ 8082)
- **é…ç½®æ–‡ä»¶å®Œæ•´æ€§** âœ…

### âš ï¸ éœ€è¦æ‰‹åŠ¨æ“ä½œï¼š
- **Docker Desktop** - éœ€è¦å¯åŠ¨ä»¥è¿è¡Œå®¹å™¨åŒ–æµ‹è¯•
- **Redis** - å¯é€‰ï¼Œç”¨äºç¼“å­˜åŠŸèƒ½æµ‹è¯•

## ğŸš€ æ¨èçš„æµ‹è¯•æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šéªŒè¯åŸºæœ¬åŠŸèƒ½
```bash
# è¿è¡Œç®€å•æµ‹è¯•ï¼ˆå¿…é¡»é€šè¿‡ï¼‰
./test_mcp_gateway/simple_test.sh
```

### ç¬¬äºŒæ­¥ï¼šè¯Šæ–­ç¯å¢ƒï¼ˆå¦‚æœ‰é—®é¢˜ï¼‰
```bash
# è¯Šæ–­ç³»ç»Ÿç¯å¢ƒ
./test_mcp_gateway/diagnose.sh
```

### ç¬¬ä¸‰æ­¥ï¼šå…¨é¢æµ‹è¯•ï¼ˆæ— éœ€Dockerï¼‰
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ï¼ˆä¸éœ€è¦å®¹å™¨ï¼‰
./test_mcp_gateway/test_without_docker.sh
```

### ç¬¬å››æ­¥ï¼šDockerå®¹å™¨æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
```bash
# 1. å¯åŠ¨ Docker Desktop
# 2. è¿è¡Œå®¹å™¨åŒ–æµ‹è¯•
docker compose -f test_mcp_gateway/docker-compose.yml up -d
./test_mcp_gateway/run_all_tests.sh
```

## ğŸ“Š æµ‹è¯•ç»“æœéªŒè¯

### âœ… æˆåŠŸæŒ‡æ ‡ï¼š
- æ‰€æœ‰åŸºæœ¬æµ‹è¯•é€šè¿‡ (simple_test.sh)
- HTTP API å“åº”æ­£å¸¸
- MCP åè®®å·¥å…·åˆ—è¡¨å¯ç”¨
- æ•°æ®åº“è¿æ¥å’Œæ“ä½œæˆåŠŸ

### ğŸ¯ å‡†å¤‡å°±ç»ªæ ‡å‡†ï¼š
å½“çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¯´æ˜ç³»ç»Ÿå‡†å¤‡å°±ç»ªï¼š
```
ğŸ‰ All tests passed! Your mcp_srv_mgr is working correctly.

âœ¨ Key accomplishments:
  âœ… Database integration works (MySQL on port 3311)
  âœ… HTTP REST API server works (port 8080)
  âœ… MCP stdio protocol works
  âœ… MCP over HTTP protocol works (port 8082)
  âœ… Configuration files are valid

Your service manager is ready for AI model integration! ğŸ¤–
```

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ï¼šMySQL è¿æ¥å¤±è´¥
**ç—‡çŠ¶**ï¼š`âŒ MySQL connection failed`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ MySQL è¿›ç¨‹
ps aux | grep mysql

# å¯åŠ¨ Docker æ–¹å¼çš„ MySQLï¼ˆæ¨èï¼‰
docker run -d --name test-mysql -p 3311:3306 \
  -e MYSQL_ROOT_PASSWORD=nov24feb11 mysql:8.0

# æˆ–å¯åŠ¨å®Œæ•´çš„æœåŠ¡æ ˆ
docker compose -f test_mcp_gateway/docker-compose.yml up -d mysql
```

### é—®é¢˜ï¼šç«¯å£å†²çª
**ç—‡çŠ¶**ï¼š`bind: address already in use`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :8080 :8081 :8082 :8083 :3311

# æ€æ­»å ç”¨è¿›ç¨‹
kill <PID>
```

### é—®é¢˜ï¼šmcp-server æ„å»ºå¤±è´¥
**ç—‡çŠ¶**ï¼š`âŒ Failed to build mcp-server`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ›´æ–°ä¾èµ–
go mod tidy

# æ¸…ç†å¹¶é‡æ–°æ„å»º
go clean -cache
go build -o mcp-server cmd/server/main.go
```

## ğŸ‰ æˆåŠŸæ¡ˆä¾‹

åŸºäºå½“å‰æµ‹è¯•ï¼Œæ‚¨çš„ç³»ç»Ÿå·²ç»ï¼š

âœ… **æ»¡è¶³é›†æˆæ¡ä»¶**ï¼š
- mcp_srv_mgr æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸
- MySQL æ•°æ®åº“å¯ç”¨å¹¶é…ç½®æ­£ç¡®
- æ‰€æœ‰ MCP åè®®å˜ä½“å·¥ä½œæ­£å¸¸
- Unla Gateway é…ç½®æ–‡ä»¶å®Œæ•´

âœ… **å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥**ï¼š
1. å¯åŠ¨ Unla Gatewayï¼š`./mcp-gateway --config test_mcp_gateway/unla-config.yaml`
2. æµ‹è¯• AI æ¨¡å‹é›†æˆ
3. éªŒè¯ç«¯åˆ°ç«¯å·¥ä½œæµç¨‹

æ‚¨çš„ Linux æœåŠ¡ç®¡ç†ç³»ç»Ÿå·²ç»æˆåŠŸå‡†å¤‡å¥½ä¸ Unla Gateway é›†æˆï¼Œä¸º AI æ¨¡å‹æä¾›å¼ºå¤§çš„ç³»ç»Ÿç®¡ç†èƒ½åŠ›ï¼ğŸš€